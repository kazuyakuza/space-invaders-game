import { Enemy } from './Enemy';\n\ntype Vector2 = { x: number; y: number };\n\ninterface EnemyWaveConfig {\n    canvasWidth: number;\n    canvasHeight: number;\n    cols: number;\n    rows: number;\n    spacingX: number;\n    spacingY: number;\n    startX: number;\n    startY: number;\n    speed: number;\n    dropDistance: number;\n}\n\nexport class EnemyWave {\n    private enemies: Enemy[] = [];\n    private direction: number = 1;\n    private speed: number;\n    private readonly dropDistance: number;\n    private readonly canvasWidth: number;\n    private readonly canvasHeight: number;\n\n    constructor(config: EnemyWaveConfig) {\n        this.speed = config.speed;\n        this.dropDistance = config.dropDistance;\n        this.canvasWidth = config.canvasWidth;\n        this.canvasHeight = config.canvasHeight;\n        this.initializeEnemies(config);\n    }\n\n    private initializeEnemies(config: EnemyWaveConfig): void {\n        for (let row = 0; row < config.rows; row++) {\n            for (let col = 0; col < config.cols; col++) {\n                const x = config.startX + col * config.spacingX;\n                const y = config.startY + row * config.spacingY;\n                this.enemies.push(new Enemy(x, y));\n            }\n        }\n    }\n\n    public update(): boolean {\n        const offset: Vector2 = { x: this.speed * this.direction, y: 0 };\n        let hitEdge = false;\n\n        for (const enemy of this.enemies) {\n            enemy.move(offset);\n        }\n\n        for (const enemy of this.enemies) {\n            const bounds = enemy.getBounds();\n            if ((this.direction < 0 && bounds.x <= 0) || (this.direction > 0 && bounds.x + bounds.width >= this.canvasWidth)) {\n                hitEdge = true;\n                break;\n            }\n        }\n\n        if (hitEdge) {\n            this.direction *= -1;\n            const dropOffset: Vector2 = { x: 0, y: this.dropDistance };\n            for (const enemy of this.enemies) {\n                enemy.move(dropOffset);\n            }\n            this.speed *= 1.001;\n        }\n\n        // Check lose condition\n        for (const enemy of this.enemies) {\n            if (enemy.getBounds().y + enemy.getBounds().height >= this.canvasHeight - 100) {\n                return false; // lose\n            }\n        }\n\n        return true; // continue\n    }\n\n    public draw(ctx: CanvasRenderingContext2D): void {\n        for (const enemy of this.enemies) {\n            enemy.draw(ctx);\n        }\n    }\n\n    public getEnemies(): Enemy[] {\n        return this.enemies;\n    }\n\n    public removeEnemy(enemy: Enemy): void {\n        const index = this.enemies.indexOf(enemy);\n        if (index > -1) {\n            this.enemies.splice(index, 1);\n        }\n    }\n\n    public isEmpty(): boolean {\n        return this.enemies.length === 0;\n    }\n}